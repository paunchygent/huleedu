---
description: Always use if linting issues are reported
globs: 
alwaysApply: false
---
===
# 110.5: Refactoring/Linting Mode

## 1. Purpose
This rule defines your (AI agent's) guidelines when operating in Refactoring/Linting Mode.

## 2. Guidelines

### 2.1. Rule: Adhere to Python Coding Standards
    - When refactoring code or addressing linting issues, **MUST** strictly follow all rules in [050-python-coding-standards.mdc](mdc:050-python-coding-standards.mdc).
    - This includes applying Black formatting, isort import sorting, and addressing Flake8 and Mypy issues.

### 2.2. Rule: Use PDM Scripts for Tooling
    - **MUST** use `pdm run format`, `pdm run lint`, and `pdm run typecheck` when proposing commands to automatically fix formatting, sort imports, or identify linting/typing issues.

### 2.3. Rule: Prioritize Clarity and Maintainability
    - Refactoring **SHOULD** aim to improve code readability, reduce complexity, remove duplication, and enhance maintainability without changing the code's external behavior.

### 2.4. Rule: Address Linting and Typing Issues Systematically
    - **MUST** address reported Flake8 and Mypy errors/warnings methodically.
    - For Mypy errors, **MUST** ensure correct and precise type hints are added or corrected.

### 2.5. Rule: Use the `edit_file` Tool for Changes
    - **MUST** use the `edit_file` tool to propose refactoring changes or apply linting/typing fixes.
    - Ensure the `code_edit` accurately reflects the necessary changes and uses the `// ... existing code ...` marker correctly.

### 2.6. Rule: Verify Changes with Tests
    - After refactoring or applying fixes, **MUST** propose running relevant tests (unit, integration) to ensure that no regressions were introduced.
    - As required by [070-testing-and-quality-assurance.mdc](mdc:070-testing-and-quality-assurance.mdc), **MUST NOT** consider the task complete until tests pass.

### 2.7. Rule: Avoid Unnecessary or Disruptive Changes
    - **SHOULD** avoid large-scale, disruptive refactoring unless explicitly requested or clearly necessary to address significant technical debt or architectural violations.

### 2.8. Rule: Document Significant Refactoring
    - If refactoring significantly changes the internal structure of a module or class, **SHOULD** update relevant docstrings and inline comments.

---
**Maintaining code quality through refactoring and addressing linting issues is an ongoing responsibility.**
===
